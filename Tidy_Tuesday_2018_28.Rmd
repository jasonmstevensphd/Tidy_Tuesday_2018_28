---
title: "TidyTuesday 2018 Week 28"
author: '@jasonmstevens'
date: "October 8, 2018"
output:
  html_document:
    theme: journal
    toc: yes
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Eligible Voters and Voter Turnout!

This is my analysis of the 2018 October 9th dataset provided by rfordatascience/tidytuesday (#tidytuesday).

<p>

The article related to this dataset can be found here:

<p>

<http://www.startribune.com/minnesota-leads-nation-in-turnout/400763681/>

<p>

All the following code for this exercise can be found at my github repo here:

<p>

<https://github.com/jasonmstevensphd/Tidy_Tuesday_2018_28>

<br>

Here we go!

###Initial Exploration of the Dataset

```{r Libraries, message=FALSE, warning=FALSE, EVAL=FALSE, include=FALSE}

# This is where we import our libraries and files. We'll also add some information to be included on our plots

library(knitr)
library(tidyverse)
library(RColorBrewer)
library(lubridate)

Week28_Data <- read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2018-10-09/voter_turnout.csv")[-1]

Week28_Data$state <- tolower(Week28_Data$state)

# I include this in my plots to put a time and author stamp on the actual plot

Time_of_Analysis <- now(tz = "America/New_York")
Analyst <- "@jasonmstevens"

```

###Mapping it out
As the data were layed out by state I thought it would be interesting to plot a map. To get a sense of the data format I picked a random year (2012) and tried it out. First, there is "united states" listed in the state column. While this data are interesting it doesn't help us for mapping data so that was filtered out as was "District of Columbia". In order to make the scale more tangible the eligible voters were divided by 1 million.


```{r Map 01, echo=FALSE, message=FALSE, warning=FALSE, tidy=TRUE}

library(fiftystater)

Week_28_01 <- Week28_Data %>% filter(year == "2012", state != "united states", state != "District of Columbia") %>%
  filter(!is.na(eligible_voters)) %>%
  mutate(Eligible_Voters = eligible_voters/1000000)

Plot_28_01 <- ggplot(Week_28_01, aes(map_id = state)) + 
     geom_map(aes(fill = Eligible_Voters), map = fifty_states) + 
     expand_limits(x = fifty_states$long, y = fifty_states$lat) +
     coord_map() +
  scale_fill_continuous(type = "viridis") +
  ggtitle("Map of Eligible Voters by State (*1,000,000) in the Year 2012!") +
  labs(subtitle = paste0("Generated by ", Analyst, " on ", Time_of_Analysis)) +
  theme(plot.background = element_rect(fill = "white"))+
        theme(panel.background = element_rect(fill = "white",
                                              colour="grey50"),
  axis.line=element_blank(),axis.text.x=element_blank(),
          axis.text.y=element_blank(),axis.ticks=element_blank(),
          axis.title.x=element_blank(),
          axis.title.y=element_blank())

Plot_28_01

```